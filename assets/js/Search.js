class Search{constructor(e={}){const s=this._getElementsByData("el");this.articles=JSON.parse(e),this.searchModal=s.search,this.searchInput=s["search-input"],this.searchResult=s["search-result"],this.searchOpenToggles=s["search-open"],this.searchCloseToggle=s["search-close"],this.searchInput.addEventListener("input",this._debounce(this._onSearch)),this.searchOpenToggles.forEach((e=>{e.addEventListener("click",this._onOpen.bind(this))})),this.searchModal.addEventListener("click",this._onClose.bind(this)),this.searchCloseToggle.addEventListener("click",this._onClose.bind(this))}_onEscape(e){"Escape"===e.key&&this.searchCloseToggle.click()}_onOpen(){this.searchModal.removeAttribute("hidden"),this.searchInput.focus(),window.addEventListener("keyup",this._onEscape.bind(this))}_onClose(e){"search"!==e.target.dataset.el&&"search-close"!==e.target.dataset.el||(this.searchModal.hidden=!0,window.removeEventListener("keyup",this._onEscape.bind(this)))}_displayResult(e){const s=`<a class="modal-search__item" href="${e.url}" title="${e.title}">\n        <div class="modal-search__item-wrap">${e.title}</div>\n    </a>`;this.searchResult.insertAdjacentHTML("afterbegin",s)}_displayResultNotFound(){this.searchResult.insertAdjacentHTML("afterbegin",'<div class="modal-search__item modal-search__item--not-found">\n        <div class="modal-search__item-wrap">Ни чего не найдено</div>\n    </div>')}_displayResultDefault(){this.searchResult.insertAdjacentHTML("afterbegin",'<div class="modal-search__item modal-search__item--not-found">\n        <div class="modal-search__item-wrap">Введите ваш запрос</div>\n    </div>')}_onSearch(e){const s=e.target.value.toLowerCase(),t=this.articles.filter((e=>{const t=e.title.toLowerCase(),a=e.description.toLowerCase(),i=t.slice(0,5),n=a.slice(0,5),c=(e,s)=>{const t=s.split("").map((e=>`(?=.*${e})`)).join(""),a=new RegExp(t,"g");return e.match(a)};return t.includes(s)||a.includes(s)||c(i,s)||c(n,s)}));this.searchResult.innerHTML="",t.length>0&&s?t.forEach((e=>this._displayResult(e))):s?this._displayResultNotFound():this._displayResultDefault()}_debounce(e,s=300){let t;return(...a)=>{clearTimeout(t),t=setTimeout((()=>{e.apply(this,a)}),s)}}_getElementsByData(e){const s={};return document.querySelectorAll(`[data-${e}]`).forEach((t=>{const a=t.dataset[e];s[a]=s[a]?[t].concat(s[a]):t})),s}}